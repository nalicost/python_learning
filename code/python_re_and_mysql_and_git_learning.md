# 正则表达式
## 出现背景
由于文本处理极其常用，且对文本内容的搜索、定位、提取是逻辑比较复杂的，故正则表达式的出现很好的解决了该问题
## 定义
即文本的高级匹配模式，提供搜索、替换等功能。其本质是由一系列字符和特殊符号形成的字符串，此字符串即正则表达式
## 原理
通过普通字符和具有特定含义的字符来组成字符串，用以描述一定的字符串规则（比如：重复，位置等），来表达某类特定的字符串，进而进行匹配
## 格式
### 普通字符
#### 匹配规则
普通字符匹配其对应的字符
#### 实例
```re.findall('ab', 'abcdefabcd')```得到的结果为```['ab', 'ab']```
注：python中的正则表达式也可以匹配中文
### 或关系
#### 元字符
```|```
#### 匹配规则
匹配在```|```两侧的任意正则表达式
#### 实例
```re.findall('com|cn', 'https://www.baidu.com.cn')```得到的结果为```['com', 'cn']```
### 匹配单个字符
#### 元字符
```.```
#### 匹配规则
匹配除换行符的任意一个字符
#### 实例
```re.findall('张.丰', '张三丰,张四丰')```得到的结果为```['张三丰', '张四丰']```
注：多个```.```可以匹配多个字符，但不用，由于有表示重复的元字符
### 匹配字符集
#### 元字符
```[字符集]```
#### 匹配规则
匹配字符集中的任意一个字符
#### 表达形式
* ```[abc#!好]```：表示匹配其中任意一个字符
* ```[0-9]/[a-z]/[A-Z]```：表示匹配区间中的任意一个字符
* ```[#?0-9a-z]```：混合书写，一般区间表达写在后面
#### 实例
```re.findall('[aeiou], 'How are you!'')```得到的结果为```['o', 'e', 'i', 'o', 'u']```
### 匹配字符集反集
#### 元字符
```[^]```
#### 匹配规则
匹配除了字符集以外的任意一个字符
#### 实例
```re.findall('[^0-9]', 'use 007 port')```得到的结果为```['u', 's', 'e', ' ', ' ', 'p', 'o', 'r', 't']```
### 匹配字符串的开始位置
#### 元字符
```^```
#### 匹配规则
匹配目标字符串的开始位置
#### 实例
```re.findall('^Jame', 'Jame,hello')```得到的结果为```['Jame']```
```re.findall('^Jame', 'Hi,Jame')```得到的结果为```[]```
### 匹配字符串的结尾位置
#### 元字符
```$```
#### 匹配规则
匹配目标字符串的结尾位置
#### 实例
```re.findall('Jame$', 'Jame,hello')```得到的结果为```[]```
```re.findall('Jame$', 'Hi,Jame')```得到的结果为```['Jame']```
注：如果```^```与```$```同时出现，则可以实现完全匹配的效果
### 匹配字符串重复
#### 元字符（1）
```*```
##### 匹配规则
匹配前面的字符出现0次或多次
##### 实例
```re.findall('wo*', 'wooooo~~w!')```得到的结果为```['wooooo', 'w']```
#### 元字符（2）
```+```
##### 匹配规则
匹配前面的字符出现1次或多次
##### 实例
```re.findall('wo+', 'wooooo~~w!')```得到的结果为```['wooooo']```
#### 元字符（3）
```?```
##### 匹配规则
匹配前面的字符出现0次或1次
##### 实例
```re.findall('-?[0-9]+', 'Jame,age:18,-26')```得到的结果为```['18', '-26']```
#### 元字符（4）
```{n}```
##### 匹配规则
匹配前面的字符出现n次
##### 实例
```re.findall('1[0-9]{10}', 'Jame:13886495728')```得到的结果为```['13886495728']```
#### 元字符（5）
```{m,n}```
##### 匹配规则
匹配前面的字符出现m~n次
##### 实例
```re.findall('[1-9][0-9]{5,10}', 'Baron:1259296994')```得到的结果为```['1259296994']```
### 匹配任意（非）数字字符
#### 元字符
```\d```与```\D```
#### 匹配规则
```\d```匹配任意数字字符，```\D```匹配任意非数字字符
#### 实例
```re.findall('\d{1,5}', 'MySQL:3306,http:80')```得到的结果是```['3306', '80']```
### 匹配任意（非）普通字符
#### 元字符
```\d```与```\D```
#### 匹配规则
```\w```匹配任意普通字符，```\W```匹配任意非普通字符
#### 实例
```re.findall('\w+', 'server-port='8888'')```得到的结果是```['server-port', '8888']```
注：普通字符指的是数字，字母，下划线，汉字等
### 匹配开头结尾位置
#### 元字符
```\A```与```\Z```
#### 匹配规则
```\A```匹配开头位置，```\Z```匹配结尾位置
### 匹配匹配（非）单词的边界位置
#### 元字符
```\b```与```\B```
#### 匹配规则
```\b```匹配单词边界，```\B```匹配非单词边界
#### 实例
```re.findall('\b\w+', ' Hello 123.4')```得到的结果是```['Hello', '123']```
注：单词边界指的是数字、字母（汉字）、下划线与其他字符的交界处
### 贪婪与非贪婪模式
#### 定义
* 贪婪模式（default）：匹配重复的元字符总是尽可能多的向后匹配内容
* 非贪婪模式（懒惰模式）：匹配重复的元字符总是尽可能少的向后匹配内容
#### 贪婪模式转化为非贪婪模式的表达
在匹配重复元字符后加```?```即可，如：```*?```或```+?```或```{m,n}?```
### 正则表达式分组
#### 定义
在正则表达式中，以```()```建立正则表达式的内部分组，子组是正则表达式的一部分，可以作为内部整体成为操作对象
#### 作用
可以作为整体操作，改变元字符的操作对象
如：```re.search('(ab+), 'ababababab'.group())```得到的结果是```abababab```
#### 捕获组
##### 定义
给正则表达式的子组起一个名字，表达子组的意义，这种有名字的子组即为捕获组
##### 格式
```(?P<name>pattern)```
##### 实例
```re.search(r'(?P<pig>ab)+'.group('pig'))```得到的结果为```'ab'```
#### 注意事项
* 一个正则表达式中可以包含多个子组
* 子组可以嵌套，但是不要重叠或嵌套结构过于复杂
* 子组序列一般从外到内，从左到右计数
## 正则表达式匹配原则
* 正确性：能正确匹配出字符串
* 排他性：除目标字符串，尽可能减少其他字符串
* 全面性：尽可能考虑到字符串的所有情况，不遗漏
## Python Re 模块
### 模块内常用函数或对象
#### re中可直接调用的正则匹配函数
* ```re.findall(pattern, string, flags=0)```
  * 功能：根据正则表达式匹配目标字符串中的内容
  * 参数
    * pattern：正则表达式
    * string：目标字符串
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：匹配到的内容列表，但如果正则表达式中包含子组，则只能获取子组对应的内容
* ``` re.split(pattern, string, flags=0)```
  * 功能：使用正则表达式匹配到的内容来切割目标字符串
  * 参数
    * pattern：正则表达式
    * string：目标字符串
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：切割后的内容列表
* ```re.sub(pattern, replace, string, max, flags=0)```
  * 功能：使用一个字符串替换正则表达式匹配到的内容
  * 参数
    * pattern：正则表达式
    * replace：替换的字符串
    * string：目标字符串
    * max：最多替换几处，默认全部
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：替换后的字符串
* ```re.finditer(pattern, string, flags=0)```
  * 功能：根据正则表达式匹配目标字符串中的内容
  * 参数
    * pattern：正则表达式
    * string：目标字符串
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：匹配结果的迭代器（match对象）
* ```re.fullmatch(pattern, string, flags=0)```
  * 功能：完全匹配某个目标字符串
  * 参数
    * pattern：正则表达式
    * string：目标字符串
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：match对象
* ```re.match(pattern, string, flags=0)```
  * 功能：匹配目标字符串的开始位置
  * 参数
    * pattern：正则表达式
    * string：目标字符串
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：match对象
* ```re.search(pattern, string, flags=0)```
  * 功能：匹配每个字符串中的第一个符合的内容
  * 参数
    * pattern：正则表达式
    * string：目标字符串
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：match对象
#### re中通过生成正则表达式（compile）对象调用相关实例方法及属性
##### 属性
* ```regex.flags```
  * 功能：返回flags值
  * 返回值：int，默认32
* ```regex.pattern```
  * 功能：返回正则表达式
  * 返回值：str类型
* ```regex.groupindex```
  * 功能：返回捕获组的名称与组号
  * 返回值：dict类型
* ```regex.groups```
  * 功能：返回子组数量
  * 返回值：int类型
##### 实例方法
* ```regex = compile(pattern, flags=0)```
  * 功能：生成正则表达式对象
  * 参数
    * pattern：正则表达式
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：正则表达式对象
* ```regex.findall(string, pos, endpos)```
  * 功能：根据正则表达式匹配目标字符串中的内容
  * 参数
    * string：目标字符串
    * pos：开始匹配的位置
    * endpos：结束匹配的位置
  * 返回值：匹配到的内容列表，但如果正则表达式中包含子组，则只能获取子组对应的内容

注：由于compile对象拥有的实例方法与re中直接调用是一致的，区别在于函数多一些参数，故只以findall为例展示
#### match对象
##### 属性
* ```obj.pos```
  * 功能：返回目标字符串开始位置
  * 返回值：int类型
* ```obj.endpos```
  * 功能：返回目标字符串开始位置
  * 返回值：int类型
* ```obj.re```
  * 功能：返回正则表达式
  * 返回值：str类型
* ```obj.string```
  * 功能：返回目标字符串
  * 返回值：str类型
* ```obj.lastgroup```
  * 功能：返回最后一组子组组号
  * 返回值：str类型
* ```obj.lastindex```
  * 功能：返回最后一组子组序列号
  * 返回值：int类型
##### 实例方法
* ```obj.span()```
  * 功能：返回被匹配内容在目标字符串中的位置
  * 返回值：int类型
* ```obj.start()```
  * 功能：返回匹配内容在目标字符串中的开始位置
  * 返回值：int类型
* ```obj.end()```
  * 功能：返回匹配内容在目标字符串中的结束位置
  * 返回值：int类型
* ```obj.groupdict()```
  * 功能：获取捕获组字典
  * 返回值：dict类型
* ```obj.groups()```
  * 功能：获取子组对应内容元组
  * 返回值：tuple类型
* ```obj.group(target)```
  * 功能：获取obj的内容（re匹配到的字符串）或返回子组对应的内容
  * 参数
    * target：数字则对应对应的子组，字符串则对应对应的捕获组，不写则返回全部内容
* 返回值：str类型
### flags参数
#### 作用
扩展并丰富正则表达式的匹配功能
#### 常用flag
* ```A```/```ASCII```：只匹配ASCII码
* ```I```/```IGNORANCE```：无视字母大小写
* ```S```/```DOTALL```：使```.```可以匹配换行
* ```M```/```MULTILINE```：使```^```和```$```可以匹配每一行的开头与结尾
* ```X```/```VERBOSE```：为正则表达式添加注释
  * 格式为
    ```python
    r'''a+ # 匹配多个a，至少一个
        \w # 匹配一个字符'''
    ``` 

注：当使用多个flag时，用```|```隔开
# 数据库
## 数据存储阶段
1. 人工管理工具
   * 缺点：数据无法共享，不能单独保持，数据存储量有限 
2. 文件管理阶段（.txt/.doc/.xls）
   * 优点：数据可以长期保存，可以存储大量数据，使用简单
   * 缺点：数据一致性差，数据查找修改不方便，数据冗余度可能比较大 
3. 数据库管理阶段
   * 优点：数据组织结构化降低了冗余度，提高了增删改查的效率，容易扩展，方便程序调用，做自动化处理
   * 缺点：需要使用sql或者其他特定的语句，相对比较复杂
## 数据库应用
* 金融机构，游戏网站，购物网站，论坛网站
* 图示
  ![图片](2024-09-26_153800.png) 
## 数据库基础概念
* 数据：能够输入到计算机并被识别处理的信息集合
* 数据结构：研究一个数据集合中数据之间的关系
* 数据库：按照数据结构存储管理数据的仓库。数据库实在数据库管理系统和控制下，在一定介质上的数据集合
* 数据库管理系统：管理数据库的软件，用于建立和维护数据库
* 数据库系统：由数据库和数据库管理系统和开发工具等组成的集合
* 数据元素：一个实实在在的数据
* 记录：一行数据元素的集合
* 数据表：由多行记录组成的集合体
* 数据库：由多个数据表组成的集合体
* 字段：数据表中每列的表头，用来表示该列的含义
## 数据库分类和常见数据库
### 关系型数据库和非关系型数据库
#### 概念解析
* 关系型：采用关系模型（二维表）来组织数据结构的数据库
* 非关系型：采用关系模型来组织数据结构的数据库，如：三维表
#### 常见数据库
* 关系型：MySQL
* 非关系型：MongoDB
### 开源数据库和非开源数据库
#### 概念解析
* 开源：免费使用，向外展示源代码
* 非开源：付费
#### 常见数据库
* 开源：MySQL，SQLite，MongoDB
* 非开源：Oracle，DB2，SQL_Server
## 数据库结构（图库结构） --  MySQL
![图片](2024-09-26_230253.png)
## 数据表结构初步设计
1. 分析存储内容
2. 确定字段构成
3. 设计字段类型
## SQL语句
### 定义
结构化查询语言（Structured Query Language），一种特殊目的的编程语言，是一种数据库查询和程序设计语言，用于存取数据以及查询，更新和管理数据库系统
### 使用特点
* SQL语句基本上独立于数据库本身
* 各种不同数据库对SQL语言的支持与标准存在着细微的不同
* 每条命令必须以```;```结尾
* SQL语句关键字不区分字母大小写
### 具体使用
#### 库名命名规则
* 数字、字母、下划线，但不能纯数字
* 库名区分字母大小写
* 不能使用特殊字符或者MySQL关键字
#### 数据类型支持
##### 数字类型
###### 整数类型（精确值）
* INTEGER/INT
* SMALLINT
* TINYINT
* MEDIUMINT
* BIGINT
注：后面可以加上括号，写上在各自范围内的数字来限定存储的最大数字
###### 定点类型
* DECIMAL
注：后面要加上括号，写上两位数字并用逗号隔开；第一位数字表示数字总长度，取值范围为1~65，默认为10；第二位数字表示小数点后的数字长度（标度），其范围是0~30，但不可超过前者
###### 浮点类型（近似值）
* FLOAT
* DOUBLE
注：后面可以加上括号，写上在各自范围内的数字来限定存储的最大数字
###### 比特值类型（0，1 -- True，False）
* BIT

另：数字类型表
|类型|占用大小（byte）|有符号取值范围|无符号取值范围|
|:----:|:----:|:----:|:----:|
|TINYINT|1|(-128, 127)|(0, 255)|
|SMALLINT|2|(-32768, 32767)|(0, 65535)|
|MEDIUMINT|3|(-8388608, 8388607)|(0, 1677215)|
|INT/INTEGER|4|(-2147483648, 214783647)|(0, 4294967295)|
|BIGINT|8|(-9223372036854775808, 922372036854775807)|(0, 1844674407370955165)|
|FLOAT|4|(-3.40282346E+38, -1.175494351E-38), 0, (1.175494351E-38, -3.40282346E+38)|0, (1.175494351E-38, 3.40282346E+38)|
|DOUBLE|8|(-1.7976931348623157E+308, -2.2250736585072014E-308), 0, (2.2250736585072014E-308, 1.7976931348623157E+308)|0, (2.2250736585072014E-308, 1.7976931348623157E+308)|
|DECIMAL(M, D)|依赖于M，D的值|依赖于M，D的值|依赖于M，D的值| 
##### 字符串类型
###### char和varchar
* char：定长，效率高，一般用于固定长度的表单提交数据存储，默认一个字符
* varchar：不定长，效率偏低
注：后面要括号加上数字，表明最多写入多少个字符
###### text和blob
* text：用来存储非二进制文本
* blob：用来存储二进制字节串
###### enum和set
* enum：用来存储给出的若干值中的一个
* set：用来存储给出的若干值中的一个或多个值

另：字符串类型表
|类型|占用空间大小（byte）|
|:----:|:----:|
|CHAR|0-255|
|VARCHAR|0-66535|
|TINYBLOB|0-255|
|TINYTEXT|0-255|
|BLOB|0-66535|
|TEXT|0-66535|
|MEDIUMBLOB|0-16777215|
|MEDIUMTEXT|0-16777215|
|LONGBLOB|0-4294967295|
|LONGTEXT|0-4294967295|
#### 数据运算逻辑符
##### 运算符
* +
* -
* *
* / 或 DIV
* % 或 MOD
##### 比较运算符
* =
* != 或 /<>
* >
* <
* <=
* >=
* BETWEEN：在两值之间
* NOT BETWEEN：不在两值之间
* IN：在集合中
* NOT IN：不在集合中
* <=>：严格比较两个NULL值是否相等
* LIKE：模糊匹配
* REGEXP 或 RLIKE：正则匹配
* IS NULL
* IS NOT NULL
##### 逻辑运算符
* NOT 或 !
* AND
* OR
* XOR：异或
##### 位运算符
* &：按位与
* |：按位或
* ^：按位异或
* !：取反
* <<：左移
* >>：右移
#### 数据库操作
* 查看已有库
  * ```show databases;```
* 创建库（指定字符集）
  * ```create database 库名 [character set utf8];```
  * ```create database 库名 [charset = utf8];```
* 查看创建库的语句
  * ```show create database 库名;```
* 切换库
  * ```use 库名```
* 查看当前所在库
  * ```select database();```
* 删除库
  * ```drop database 库名;```
#### 数据表操作
##### 表的基本操作
* 创建表
  * ```create table 表名 (字段名 数据类型 附加内容, ...);```
    * unsigned：设置数字只能为正
    * not null：设置字段传值不能为空
    * default：设置一个字段的默认值，后面直接写即可
    * primary key：定义列为主键，主键不能为空且值不能重复
    * auto_increment：定义列自增，一般用于主键，每放入一个数据，数值自动加1
* 查看数据表
  * ```show tables;```
* 查看已有表的创建语句
  * ```show create table 表名;```
* 查看表结构
  * ```desc 表名;```
* 删除表
  * ```drop table 表名;```
##### 表的数据操作
* 插入数据
  * ```insert into 表名 values (记录1), (记录2), ...;```
  * ```insert into 表名 (字段1, 字段2, ...) values (记录1), (记录2), ...;```

  注：若没有特殊指明字段，记录要包含所有字段（包括有默认值，自增）；如果特殊指明字段，记录只需包含指明的字段即可
* 查找数据
  * ```select * from 表名 [where 条件;]```
  * ```select 字段1, 字段2, ... from 表名 [where 条件;]```
* 更新记录
  * ```update 表名 set 字段1 = 值1, 字段2 = 值2, ... where 条件;```
* 删除表记录
  * ```delete from 表名 where 条件;```
##### 表的字段操作
#### 数据表的管理
## MySQL数据库
### 特点
* 是开源数据库
* 能够工作在不同的平台上
* 提供了用于C，C++，Python，Java，Perl，PHP，Ruby众多语言的API
* 存储结构优良，运行速度快
* 功能全面丰富
### Mysql语句
* 查看Mysql数据库运行状态
  * ```sudo /etc/init.d/mysql status
* 客户端连接
  * ```mysql -h主机地址 -u用户名 -p密码```
  
  注：本地连接可省略```-h```；主机地址包含IP与端口
* 启动连接
  * ```sudo /etc/init.d/mysql start```
  * ```sudo /etc/init.d/mysql restart```
* 关闭连接
  * ```sudo /etc/init.d/mysql stop```
* 退出Mysql命令台  
  * ```exit```
  * crtl键+d键
* 备份命令
  * ```mysqldump -u用户名 -p 源库名 > 路径/文件名.sql```
    * 备份所有库：```mysqldump -u用户名 -p --all-databases > 路径/文件名.sql```
    * 备份多个库：```mysqldump -u用户名 -p -B 库1 库2 ... > 路径/文件名.sql```
    * 备份库中指定个表：```mysqldump -u用户名 -p 源库名 表1 表2 ...> 路径/文件名.sql```
* 恢复命令
  * ```mysql -u用户名 -p 目标库名 < 路径/文件名.sql```
    * 从所有库中恢复某一个库：```mysql -u用户名 -p --one-database 目标库名 < 路径/文件名.sql```

  注：目标库要先创建
