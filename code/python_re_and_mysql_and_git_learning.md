# 正则表达式
## 出现背景
由于文本处理极其常用，且对文本内容的搜索、定位、提取是逻辑比较复杂的，故正则表达式的出现很好的解决了该问题
## 定义
即文本的高级匹配模式，提供搜索、替换等功能。其本质是由一系列字符和特殊符号形成的字符串，此字符串即正则表达式
## 原理
通过普通字符和具有特定含义的字符来组成字符串，用以描述一定的字符串规则（比如：重复，位置等），来表达某类特定的字符串，进而进行匹配
## 格式
### 普通字符
#### 匹配规则
普通字符匹配其对应的字符
#### 实例
```re.findall('ab', 'abcdefabcd')```得到的结果为```['ab', 'ab']```
注：python中的正则表达式也可以匹配中文
### 或关系
#### 元字符
```|```
#### 匹配规则
匹配在```|```两侧的任意正则表达式
#### 实例
```re.findall('com|cn', 'https://www.baidu.com.cn')```得到的结果为```['com', 'cn']```
### 匹配单个字符
#### 元字符
```.```
#### 匹配规则
匹配除换行符的任意一个字符
#### 实例
```re.findall('张.丰', '张三丰,张四丰')```得到的结果为```['张三丰', '张四丰']```
注：多个```.```可以匹配多个字符，但不用，由于有表示重复的元字符
### 匹配字符集
#### 元字符
```[字符集]```
#### 匹配规则
匹配字符集中的任意一个字符
#### 表达形式
* ```[abc#!好]```：表示匹配其中任意一个字符
* ```[0-9]/[a-z]/[A-Z]```：表示匹配区间中的任意一个字符
* ```[#?0-9a-z]```：混合书写，一般区间表达写在后面
#### 实例
```re.findall('[aeiou], 'How are you!'')```得到的结果为```['o', 'e', 'i', 'o', 'u']```
### 匹配字符集反集
#### 元字符
```[^]```
#### 匹配规则
匹配除了字符集以外的任意一个字符
#### 实例
```re.findall('[^0-9]', 'use 007 port')```得到的结果为```['u', 's', 'e', ' ', ' ', 'p', 'o', 'r', 't']```
### 匹配字符串的开始位置
#### 元字符
```^```
#### 匹配规则
匹配目标字符串的开始位置
#### 实例
```re.findall('^Jame', 'Jame,hello')```得到的结果为```['Jame']```
```re.findall('^Jame', 'Hi,Jame')```得到的结果为```[]```
### 匹配字符串的结尾位置
#### 元字符
```$```
#### 匹配规则
匹配目标字符串的结尾位置
#### 实例
```re.findall('Jame$', 'Jame,hello')```得到的结果为```[]```
```re.findall('Jame$', 'Hi,Jame')```得到的结果为```['Jame']```
注：如果```^```与```$```同时出现，则可以实现完全匹配的效果
### 匹配字符串重复
#### 元字符（1）
```*```
##### 匹配规则
匹配前面的字符出现0次或多次
##### 实例
```re.findall('wo*', 'wooooo~~w!')```得到的结果为```['wooooo', 'w']```
#### 元字符（2）
```+```
##### 匹配规则
匹配前面的字符出现1次或多次
##### 实例
```re.findall('wo+', 'wooooo~~w!')```得到的结果为```['wooooo']```
#### 元字符（3）
```?```
##### 匹配规则
匹配前面的字符出现0次或1次
##### 实例
```re.findall('-?[0-9]+', 'Jame,age:18,-26')```得到的结果为```['18', '-26']```
#### 元字符（4）
```{n}```
##### 匹配规则
匹配前面的字符出现n次
##### 实例
```re.findall('1[0-9]{10}', 'Jame:13886495728')```得到的结果为```['13886495728']```
#### 元字符（5）
```{m,n}```
##### 匹配规则
匹配前面的字符出现m~n次
##### 实例
```re.findall('[1-9][0-9]{5,10}', 'Baron:1259296994')```得到的结果为```['1259296994']```
### 匹配任意（非）数字字符
#### 元字符
```\d```与```\D```
#### 匹配规则
```\d```匹配任意数字字符，```\D```匹配任意非数字字符
#### 实例
```re.findall('\d{1,5}', 'MySQL:3306,http:80')```得到的结果是```['3306', '80']```
### 匹配任意（非）普通字符
#### 元字符
```\d```与```\D```
#### 匹配规则
```\w```匹配任意普通字符，```\W```匹配任意非普通字符
#### 实例
```re.findall('\w+', 'server-port='8888'')```得到的结果是```['server-port', '8888']```
注：普通字符指的是数字，字母，下划线，汉字等
### 匹配开头结尾位置
#### 元字符
```\A```与```\Z```
#### 匹配规则
```\A```匹配开头位置，```\Z```匹配结尾位置
### 匹配匹配（非）单词的边界位置
#### 元字符
```\b```与```\B```
#### 匹配规则
```\b```匹配单词边界，```\B```匹配非单词边界
#### 实例
```re.findall('\b\w+', ' Hello 123.4')```得到的结果是```['Hello', '123']```
注：单词边界指的是数字、字母（汉字）、下划线与其他字符的交界处
### 贪婪与非贪婪模式
#### 定义
* 贪婪模式（default）：匹配重复的元字符总是尽可能多的向后匹配内容
* 非贪婪模式（懒惰模式）：匹配重复的元字符总是尽可能少的向后匹配内容
#### 贪婪模式转化为非贪婪模式的表达
在匹配重复元字符后加```?```即可，如：```*?```或```+?```或```{m,n}?```
### 正则表达式分组
#### 定义
在正则表达式中，以```()```建立正则表达式的内部分组，子组是正则表达式的一部分，可以作为内部整体成为操作对象
#### 作用
可以作为整体操作，改变元字符的操作对象
如：```re.search('(ab+), 'ababababab'.group())```得到的结果是```abababab```
#### 捕获组
##### 定义
给正则表达式的子组起一个名字，表达子组的意义，这种有名字的子组即为捕获组
##### 格式
```(?P<name>pattern)```
##### 实例
```re.search(r'(?P<pig>ab)+'.group('pig'))```得到的结果为```'ab'```
#### 注意事项
* 一个正则表达式中可以包含多个子组
* 子组可以嵌套，但是不要重叠或嵌套结构过于复杂
* 子组序列一般从外到内，从左到右计数
## 正则表达式匹配原则
* 正确性：能正确匹配出字符串
* 排他性：除目标字符串，尽可能减少其他字符串
* 全面性：尽可能考虑到字符串的所有情况，不遗漏
## Python Re 模块
### 模块内常用函数或对象
#### re中可直接调用的正则匹配函数
* ```re.findall(pattern, string, flags=0)```
  * 功能：根据正则表达式匹配目标字符串中的内容
  * 参数
    * pattern：正则表达式
    * string：目标字符串
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：匹配到的内容列表，但如果正则表达式中包含子组，则只能获取子组对应的内容
* ``` re.split(pattern, string, flags=0)```
  * 功能：使用正则表达式匹配到的内容来切割目标字符串
  * 参数
    * pattern：正则表达式
    * string：目标字符串
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：切割后的内容列表
* ```re.sub(pattern, replace, string, max, flags=0)```
  * 功能：使用一个字符串替换正则表达式匹配到的内容
  * 参数
    * pattern：正则表达式
    * replace：替换的字符串
    * string：目标字符串
    * max：最多替换几处，默认全部
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：替换后的字符串
* ```re.finditer(pattern, string, flags=0)```
  * 功能：根据正则表达式匹配目标字符串中的内容
  * 参数
    * pattern：正则表达式
    * string：目标字符串
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：匹配结果的迭代器（match对象）
* ```re.fullmatch(pattern, string, flags=0)```
  * 功能：完全匹配某个目标字符串
  * 参数
    * pattern：正则表达式
    * string：目标字符串
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：match对象
* ```re.match(pattern, string, flags=0)```
  * 功能：匹配目标字符串的开始位置
  * 参数
    * pattern：正则表达式
    * string：目标字符串
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：match对象
* ```re.search(pattern, string, flags=0)```
  * 功能：匹配每个字符串中的第一个符合的内容
  * 参数
    * pattern：正则表达式
    * string：目标字符串
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：match对象
#### re中通过生成正则表达式（compile）对象调用相关实例方法及属性
##### 属性
* ```regex.flags```
  * 功能：返回flags值
  * 返回值：int，默认32
* ```regex.pattern```
  * 功能：返回正则表达式
  * 返回值：str类型
* ```regex.groupindex```
  * 功能：返回捕获组的名称与组号
  * 返回值：dict类型
* ```regex.groups```
  * 功能：返回子组数量
  * 返回值：int类型
##### 实例方法
* ```regex = compile(pattern, flags=0)```
  * 功能：生成正则表达式对象
  * 参数
    * pattern：正则表达式
    * flags：功能标志位，扩展正则表达式的匹配
  * 返回值：正则表达式对象
* ```regex.findall(string, pos, endpos)```
  * 功能：根据正则表达式匹配目标字符串中的内容
  * 参数
    * string：目标字符串
    * pos：开始匹配的位置
    * endpos：结束匹配的位置
  * 返回值：匹配到的内容列表，但如果正则表达式中包含子组，则只能获取子组对应的内容

注：由于compile对象拥有的实例方法与re中直接调用是一致的，区别在于函数多一些参数，故只以findall为例展示
#### match对象
##### 属性
* ```obj.pos```
  * 功能：返回目标字符串开始位置
  * 返回值：int类型
* ```obj.endpos```
  * 功能：返回目标字符串开始位置
  * 返回值：int类型
* ```obj.re```
  * 功能：返回正则表达式
  * 返回值：str类型
* ```obj.string```
  * 功能：返回目标字符串
  * 返回值：str类型
* ```obj.lastgroup```
  * 功能：返回最后一组子组组号
  * 返回值：str类型
* ```obj.lastindex```
  * 功能：返回最后一组子组序列号
  * 返回值：int类型
##### 实例方法
* ```obj.span()```
  * 功能：返回被匹配内容在目标字符串中的位置
  * 返回值：int类型
* ```obj.start()```
  * 功能：返回匹配内容在目标字符串中的开始位置
  * 返回值：int类型
* ```obj.end()```
  * 功能：返回匹配内容在目标字符串中的结束位置
  * 返回值：int类型
* ```obj.groupdict()```
  * 功能：获取捕获组字典
  * 返回值：dict类型
* ```obj.groups()```
  * 功能：获取子组对应内容元组
  * 返回值：tuple类型
* ```obj.group(target)```
  * 功能：获取obj的内容（re匹配到的字符串）或返回子组对应的内容
  * 参数
    * target：数字则对应对应的子组，字符串则对应对应的捕获组，不写则返回全部内容
* 返回值：str类型
### flags参数
#### 作用
扩展并丰富正则表达式的匹配功能
#### 常用flag
* ```A```/```ASCII```：只匹配ASCII码
* ```I```/```IGNORANCE```：无视字母大小写
* ```S```/```DOTALL```：使```.```可以匹配换行
* ```M```/```MULTILINE```：使```^```和```$```可以匹配每一行的开头与结尾
* ```X```/```VERBOSE```：为正则表达式添加注释
  * 格式为
    ```python
    r'''a+ # 匹配多个a，至少一个
        \w # 匹配一个字符'''
    ``` 

注：当使用多个flag时，用```|```隔开

